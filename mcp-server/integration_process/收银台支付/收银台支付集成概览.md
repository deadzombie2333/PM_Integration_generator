# 收银台支付集成概览

## 概述

该文档介绍收银台集成模式的集成流程。收银台集成模式下，用户下单后，跳转到PayerMax构建的H5收银页面支付。

## 特性

PayerMax H5收银页面具有以下特性：
- 展示可选的支付方式列表
- 自适应设备屏幕大小
- 支持多语言
- 商户无需开发收银台页面
- 极大简化商户集成
- 缩短上线周期

关于收银台集成模式的更多信息，请查看集成模式概览。

## 集成准备

在开始集成前，请完成以下准备工作：

### 1. 账号和配置
- 注册开发者中心账号
- 上传测试商户公钥
- 获取平台公钥、AppID、测试商户号等集成信息

### 2. 回调配置
- 配置回调地址（WebHook）
- 配置支付结果回调地址
- 配置退款结果回调地址

### 3. 环境配置
- 设置测试环境服务器IP白名单
- 配置并开通相应支付方式
- 查看不同环境的请求地址

### 4. 技术准备
- 理解请求报文加签和验签的原理
- 学习如何生成每次HTTP请求Header的sign签名字符串

## 环境信息

### 测试环境
```
https://pay-gate-uat.payermax.com/aggregate-pay/api/gateway/<接口PATH>
```

### 集成环境（生产环境）
```
https://pay-gate.payermax.com/aggregate-pay/api/gateway/<接口PATH>
```

## 交互流程

```
用户下单 -> 商户创建支付 -> PayerMax处理 -> 跳转收银台页面 
-> 用户选择支付方式 -> 完成支付 -> 支付结果通知 -> 商户处理结果
```

## 接口列表

| 功能 | 调用方向 | 接口PATH | 说明 |
|------|---------|----------|------|
| 创建支付 | 商户 -> PayerMax | /orderAndPay | 调用收银台下单接口 |
| 支付结果通知 | PayerMax -> 商户 | /collectResultNotifyUrl | 异步通知支付结果 |
| 查询支付交易 | 商户 -> PayerMax | /orderQuery | 主动查询支付状态 |

## 支付方式配置

PayerMax收银台集成模式支持商户自定义供用户选择的可用支付方式：

### 默认模式
- 如果商户不指定支付方式，默认展示全量支付方式
- 用户可以看到所有可用的支付选项

### 自定义模式
- 商户可以指定特定的支付方式
- PayerMax收银页会根据请求入参设定，选择性展示部分可用支付方式
- 支持指定支付方式类型（如CARD、WALLET等）
- 支持指定具体支付机构（如GCASH、DANA等）

## 支付过期时间

商户可以通过接口入参 `expireTime` 指定单笔支付的支付关单时间：

- **单位**: 秒
- **最小值**: 1800秒（30分钟）
- **最大值**: 86400秒（24小时）
- **默认行为**: 
  - 如果传入值小于1800，系统默认重置为30分钟
  - 如果传入值大于86400，系统默认重置为24小时
  - 如果不指定，则根据使用的支付方式会有所不同

## 回调地址配置

### notifyUrl（支付结果回调）
- 可以在每次请求中指定
- 也可以在PayerMax商户平台配置统一的回调地址
- 如果请求中不指定，则使用平台配置的默认地址

### frontCallbackUrl（前端跳转地址）
- 用户支付完成后跳转的商户页面
- 必须在外部浏览器上可用
- 支持多种形式（详见支付流程文档）

## 下一步

- 查看 [收银台支付接口](./收银台支付接口.md) 了解详细的API接口
- 查看 [收银台支付示例](./收银台支付示例.md) 了解不同场景的请求示例
- 查看 [收银台支付流程](./收银台支付流程.md) 了解完整的支付流程
- 查看 [收银台测试上线](./收银台测试上线.md) 了解测试和上线流程
