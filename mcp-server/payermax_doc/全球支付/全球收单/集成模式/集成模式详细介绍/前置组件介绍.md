# 前置组件介绍

前置组件是PayerMax预先构建的支付UI解决方案，用于在商户的网站上安全的接受付款。使用前置组件，后续如果添加新的支付方式，仅需与PayerMax签约新支付方式即可，不需要再做额外的开发工作。

## 1. 产品优势

### 1.1 可定制UI
商户可定制checkout页面以适配网站样式。

**定制选项：**
- 🎨 自定义主题色彩
- 🎨 调整组件样式
- 🎨 适配品牌风格
- 🎨 控制布局和间距
- 🎨 自定义字体和大小

### 1.2 易扩展性
更易扩展新的支付方式，无需二次对接开发。

**扩展优势：**
- ✅ 新支付方式自动支持
- ✅ 无需修改代码
- ✅ 无需重新集成
- ✅ 只需商务签约
- ✅ 降低维护成本

### 1.3 更安全简便
卡号、CVV等敏感信息由PayerMax组件收集托管，商户不需要自行申请PCI认证资质。

**安全优势：**
- 🔒 敏感信息不经过商户服务器
- 🔒 PayerMax托管卡信息
- 🔒 商户无需PCI-DSS认证
- 🔒 符合支付行业安全标准
- 🔒 降低安全风险和成本

## 2. 支持支付方式及示例

### 2.1 卡支付

前置组件支持主流信用卡和借记卡支付。

**支持卡类型：**
- 💳 Visa
- 💳 Mastercard
- 💳 American Express
- 💳 JCB
- 💳 Discover
- 💳 其他本地卡组织

**功能特性：**
- 实时卡号验证
- 自动识别卡类型
- CVV安全输入
- 有效期验证
- 支持保存卡信息
- 3DS验证支持

**示例场景：**
```
用户在商户页面 → 前置组件展示卡输入表单 → 用户输入卡信息 → 
组件直接与PayerMax通信 → 获取支付token → 完成支付
```

**集成示例：**
```html
<!-- 在商户页面嵌入前置组件 -->
<div id="payermax-dropin-container"></div>

<script>
// 初始化前置组件
const dropin = PayerMaxDropin.create({
  container: '#payermax-dropin-container',
  paymentMethods: ['CARD'],
  // 其他配置...
});

// 处理支付
dropin.on('submit', async (data) => {
  // 使用token完成支付
  const result = await processPayment(data.token);
});
</script>
```

### 2.2 ApplePay支付

前置组件支持ApplePay快捷支付，提供原生的Apple支付体验。

**适用设备：**
- 🍎 iPhone（iOS Safari）
- 🍎 iPad（iOS Safari）
- 🍎 Mac（Safari浏览器）
- 🍎 支持Touch ID / Face ID的设备

**功能特性：**
- 原生ApplePay按钮
- 自动检测设备支持
- 快速支付体验
- 无需输入卡信息
- 生物识别验证
- 安全令牌化

**用户体验：**
```
用户点击ApplePay按钮 → 唤起ApplePay支付界面 → 
Face ID/Touch ID验证 → 确认支付 → 完成交易
```

**集成示例：**
```javascript
// 初始化包含ApplePay的前置组件
const dropin = PayerMaxDropin.create({
  container: '#payermax-dropin-container',
  paymentMethods: ['CARD', 'APPLEPAY'],
  applePay: {
    merchantName: 'Your Store Name',
    countryCode: 'US',
    currencyCode: 'USD'
  }
});
```

**注意事项：**
- ⚠️ 需要在HTTPS环境下使用
- ⚠️ 需要在Apple开发者平台注册
- ⚠️ 需要配置域名验证
- ⚠️ 仅在支持的设备和浏览器上显示

### 2.3 GooglePay支付

前置组件支持GooglePay快捷支付，提供便捷的Google支付体验。

**适用设备：**
- 📱 Android设备（Chrome浏览器）
- 💻 桌面设备（Chrome浏览器）
- 🌐 支持GooglePay的浏览器

**功能特性：**
- 原生GooglePay按钮
- 自动检测设备支持
- 快速支付体验
- 使用Google账户支付
- 无需重复输入信息
- 安全令牌化

**用户体验：**
```
用户点击GooglePay按钮 → 唤起GooglePay支付界面 → 
选择支付卡片 → 确认支付 → 完成交易
```

**集成示例：**
```javascript
// 初始化包含GooglePay的前置组件
const dropin = PayerMaxDropin.create({
  container: '#payermax-dropin-container',
  paymentMethods: ['CARD', 'GOOGLEPAY'],
  googlePay: {
    merchantName: 'Your Store Name',
    merchantId: 'your-google-merchant-id',
    environment: 'PRODUCTION' // 或 'TEST'
  }
});
```

**注意事项：**
- ⚠️ 需要在HTTPS环境下使用
- ⚠️ 需要在Google Pay Business Console注册
- ⚠️ 需要获取Merchant ID
- ⚠️ 需要通过Google审核

## 3. 前置组件 vs 其他模式

| 对比维度 | 前置组件 | 收银台模式 | 纯API模式 |
|---------|---------|-----------|----------|
| **页面跳转** | 无需跳转 | 需要跳转 | 部分跳转 |
| **UI定制** | 中等 | 有限 | 完全自定义 |
| **PCI-DSS** | 不需要 | 不需要 | 需要（卡支付） |
| **集成难度** | 中等 | 低 | 高 |
| **新支付方式** | 自动支持 | 自动支持 | 需要开发 |
| **用户体验** | 很好 | 好 | 最好 |
| **开发成本** | 中 | 低 | 高 |
| **维护成本** | 低 | 低 | 高 |

## 4. 技术架构

### 4.1 工作原理

```
商户页面
    ↓
嵌入PayerMax前置组件（JavaScript SDK）
    ↓
用户输入支付信息
    ↓
组件直接与PayerMax服务器通信（不经过商户服务器）
    ↓
获取支付token
    ↓
商户后端使用token调用支付API
    ↓
完成支付
```

### 4.2 安全机制

**敏感信息隔离：**
- 卡号、CVV等敏感信息由组件直接发送到PayerMax
- 商户服务器不接触敏感信息
- 使用token代替敏感信息

**通信加密：**
- HTTPS加密传输
- TLS 1.2+协议
- 端到端加密

**合规性：**
- 符合PCI-DSS标准
- 商户无需PCI认证
- PayerMax负责合规

## 5. 集成要求

### 5.1 技术要求

**前端：**
- 支持现代JavaScript（ES6+）
- HTTPS环境
- 支持主流浏览器

**后端：**
- 能够调用PayerMax API
- 处理异步通知
- 管理订单状态

### 5.2 浏览器支持

| 浏览器 | 最低版本 |
|--------|---------|
| Chrome | 60+ |
| Firefox | 60+ |
| Safari | 11+ |
| Edge | 79+ |
| iOS Safari | 11+ |
| Android Chrome | 60+ |

### 5.3 开发工作量

**初次集成：**
- 开发时间：2-3天
- 前端工作：中等
- 后端工作：低
- 测试工作：中等

**新增支付方式：**
- 无需开发工作
- 只需商务签约
- 自动生效

## 6. 适用场景

### ✅ 推荐使用场景

- 需要在页面内完成支付（无跳转）
- 希望自定义支付UI
- 无PCI-DSS认证资质
- 需要支持卡支付
- 需要支持ApplePay/GooglePay
- 希望快速扩展新支付方式
- 有一定的前端开发能力

### ⚠️ 不太适合场景

- 完全无前端开发能力
- 需要极简集成
- 不需要卡支付
- 只需要钱包类支付

## 7. 最佳实践

### 7.1 UI定制建议

- 保持组件样式与网站一致
- 使用品牌色彩
- 适配移动端
- 提供清晰的支付引导

### 7.2 性能优化

- 异步加载组件SDK
- 预加载支付资源
- 优化组件初始化
- 减少不必要的API调用

### 7.3 错误处理

- 友好的错误提示
- 支持重试机制
- 记录错误日志
- 提供客服支持

### 7.4 用户体验

- 实时验证输入
- 清晰的状态反馈
- 支持多语言
- 优化加载速度

## 8. 集成步骤概览

1. **引入SDK**
   - 在页面中引入PayerMax Drop-in SDK

2. **初始化组件**
   - 配置支付方式
   - 设置样式和主题
   - 指定容器元素

3. **处理支付**
   - 监听组件事件
   - 获取支付token
   - 调用后端API完成支付

4. **处理回调**
   - 接收支付结果
   - 更新订单状态
   - 展示支付结果

## 9. 下一步

- 查看[前置组件集成文档](https://docs.payermax.com/dropin/integration)
- 体验[在线DEMO](https://demo.payermax.com/dropin)
- 下载[JavaScript SDK](https://github.com/PayerMax/payermax-dropin-js)
- 查看[API参考文档](https://docs.payermax.com/api-reference)
- 了解[UI定制指南](https://docs.payermax.com/dropin/customization)
- 查看[ApplePay集成指南](https://docs.payermax.com/dropin/applepay)
- 查看[GooglePay集成指南](https://docs.payermax.com/dropin/googlepay)
