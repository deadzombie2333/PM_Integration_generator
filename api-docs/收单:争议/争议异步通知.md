# 争议异步通知 (Dispute Async Notification)

## Endpoint
```
POST https://pay-gate-uat.payermax.com/chargeBaclNotifyUrl
```

## Request Headers

| Parameter | Type | Required | Description | Example |
|-----------|------|----------|-------------|---------|
| Content-Type | string | required | - | application/json |
| sign | string | required | 签名信息请参考技术文档 | FPFVT3o227JrFRbqu19boZCpVVTF9KznxyRawUmxpfXilHV/0yK46haPhAjNu1hPUMy7Vw/ILXhfzffNm4Fj0apWknlTY9OJxnSoQxS9BTFtc61tn5yV1q69x/kkBl82/qwg+XTJ4fOzy7Mar3VaC1E2PlDA6RkkKBUyNE6RYgsdB+Su7an4+4HVTNAnoe74WyvBgxTLMNg28igBTdqxaO3w/UBY6ObVp7vkqkQGdL1Y+HgmMYaAVwrM3+ALWGId0sJ+YqTY4WJ+0xCRGhaSnybiIjZsQEYyID68WNUfuavDLDsEhaMm/HfQvf5p0R1Ltovp3wwJnEbQcjY458iX5A== |

## Request Body (Callback from PayerMax)

**Content-Type:** `application/json`

| Parameter | Type | Required | Description | Constraints |
|-----------|------|----------|-------------|-------------|
| code | string | required | 通知code | <= 64 characters, Example: APPLY_SUCCESS |
| msg | string | required | 通知msg | <= 256 characters, Example: Success. |
| version | string | required | 接口版本 当前值为：1.4 | <= 8 characters |
| keyVersion | string | required | 密钥版本 当前值为：1 | <= 8 characters |
| requestTime | string | required | 请求时间，符合rfc3339规范，格式：yyyy-MM-dd'T'HH:mm:ss.SSSXXX 时间需要在当前时间两分钟内 | <= 32 characters |
| appId | string | required | 商户应用Id，PayerMax分配给商户应用的唯一标识 | <= 64 characters |
| merchantNo | string | optional | 商户号，商户与PayerMax业务签约时生成的唯一标识 | <= 32 characters |
| notifyTime | string | required | 通知时间，符合rfc3339规范，格式：yyyy-MM-dd'T'HH:mm:ss.SSSXXX | <= 32 characters, Example: 2022-01-22T10:00:00.500+08:00 |
| notifyType | string | required | 通知类型：CHARGEBACK（拒付）、DISPUTE（争议）、FRAUD（欺诈）、CUSTOMER COMPLAINT（用户投诉） | <= 16 characters, Example: CHARGEBACK |
| spMerchantNo | string or null | optional | ISV服务商的商户号 | <= 15 characters, Example: 010229810189301 |
| data | object | required | - | - |

### data Object

| Parameter | Type | Required | Description | Constraints |
|-----------|------|----------|-------------|-------------|
| caseId | string | required | 案件编号 | <= 64 characters, Example: O20211118090801 |
| outTradeNo | string | required | 商户订单号 | <= 64 characters, Example: 20181112112606266846 |
| tradeToken | string | required | PayerMax交易流水号 | <= 64 characters, Example: TOKEN202206210021173856 |
| channelOrderNo | string | required | 渠道订单号 | <= 64 characters, Example: TPC776377168137542977644013024 |
| outUserId | string | required | 用户号 | <= 64 characters, Example: ZNW3e |
| status | string | required | 案件状态 | <= 32 characters, Allowed: DISPUTE_INQUIRY, DISPUTE_RECEIVED, DISPUTE_END, CASE_CLOSED, CASE_CANCELL, Example: DISPUTE_INQUIRY |
| amount | string | required | 案件实际冻结支付金额，按照各国币种支持的小数点位返回 | <= 20 characters, Example: 10.00 |
| fee | string | required | 案件冻结手续费，按照各国币种支持的小数点位返回 | <= 20 characters, Example: 10.00 |
| totalAmount | string | required | 案件实际冻结总金额，实际冻结金额+实际冻结手续费，按照各国币种支持的小数点位返回 | <= 20 characters, Example: 25.00 |
| currency | string | optional | 案件实际冻结币种 | <= 3 characters, Example: INR |
| originTradeAmount | string | required | 案件应冻金额，对应原始交易订单应冻结金额，按照各国币种支持的小数点位返回 | <= 20 characters, Example: 15.00 |
| originTradeCurrency | string | required | 案件应冻币种，对应原始交易订单应冻结币种 | <= 3 characters, Example: INR |
| tradeAmount | string | required | 交易金额 | <= 20 characters, Example: 10.00 |
| tradeCurrency | string | required | 交易币种 | <= 3 characters, Example: INR |
| tradeCountry | string | required | 交易国家 | <= 8 characters, Example: INR |
| tradeCreateTime | string | required | 交易创建时间 | <= 64 characters, Example: 2022-01-22T10:00:00.500+08:00 |
| retrievalDate | string | required | 调单发起日 | <= 32 characters, Example: 2022-01-22 |
| expirationDate | string | required | 回复到期日，商户需在到期日前提交举证材料 | <= 32 characters, Example: 2022-01-22 |
| reasonCode | string | required | 争议原因编码 | <= 64 characters |
| reasonMessage | string | required | 争议原因描述 | <= 512 characters |
| caseResult | string | optional | 案件结果 商户胜诉：WIN，商户败诉：FAIL | <= 32 characters, Example: WIN |
| batchId | string or null | optional | 案件批次号，批量调单时生成 | <= 64 characters, Example: P20210702104937 |
| cardOrg | string | optional | 支付卡组 | <= 32 characters, Example: VISA |
| targetOrg | string | optional | 目标机构 | <= 32 characters, Example: OVO |
| paymentMethodType | string | optional | 支付方式类型 | <= 32 characters, Example: WALLET |
| productDesc | string | optional | 消费信息 | <= 256 characters, Example: 游戏币充值 |
| payFinishTime | string or null | optional | 支付完成时间 | <= 32 characters, Example: 2022-01-22T10:00:00.500+08:00 |

**注意：** 小概率会发生二次拒付，同一个outTradeNo可能会二次回调，请正常接收处理。

### 案件状态说明

- **DISPUTE_INQUIRY**: 调单待反馈，等待商户反馈并回复举证材料
- **DISPUTE_RECEIVED**: 举证材料已接收，仅在回调版本1.5以上返回
- **DISPUTE_END**: 调单完成发卡行审核申诉并作出判定
- **CASE_CLOSED**: 已结案
- **CASE_CANCELL**: 案件已取消，仅在回调版本1.5以上返回

### 通知类型说明

1. **CHARGEBACK（拒付）**: 指的是持卡人在支付后一定期限内（收到账单后的180天内），可以向发卡行申请拒付账单上的某笔交易。
2. **DISPUTE（争议）**: 指用户（多数为各类电子钱包、平台用户），在支付交易发生一段时间内向支付平台申诉某笔交易。
3. **FRAUD（欺诈）**: 指盗用用户身份进行交易。
4. **CUSTOMER COMPLAINT（用户投诉）**: 指用户针对某笔交易不满意商户提供的服务而向平台或支付公司发起投诉。

## Response (Merchant Response to PayerMax)

### 200 OK

**Content-Type:** `application/json`

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| code | string | required | 返回码，'SUCCESS'代表成功 |
| msg | string | required | 返回描述，'Success' |

**Example Response:**
```json
{
  "code": "SUCCESS",
  "msg": "Success"
}
```
