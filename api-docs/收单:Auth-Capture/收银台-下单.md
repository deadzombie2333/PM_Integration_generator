# 收银台-下单

## 接口信息

**请求方式:** POST

**请求地址:** `https://pay-gate-uat.payermax.com/aggregate-pay/api/gateway/orderAndPay`

## Request

### Headers

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| Content-Type | string | 是 | 内容类型 | application/json |
| sign | string | 是 | 签名信息,请参考技术文档 | FPFVT3o227JrFRbqu19boZCpVVTF9KznxyRawUmxpfXilHV/0yK46haPhAjNu1hPUMy7Vw/ILXhfzffNm4Fj0apWknlTY9OJxnSoQxS9BTFtc61tn5yV1q69x/kkBl82/qwg+XTJ4fOzy7Mar3VaC1E2PlDA6RkkKBUyNE6RYgsdB+Su7an4+4HVTNAnoe74WyvBgxTLMNg28igBTdqxaO3w/UBY6ObVp7vkqkQGdL1Y+HgmMYaAVwrM3+ALWGId0sJ+YqTY4WJ+0xCRGhaSnybiIjZsQEYyID68WNUfuavDLDsEhaMm/HfQvf5p0R1Ltovp3wwJnEbQcjY458iX5A== |

### Body (application/json)

| 参数名 | 类型 | 必填 | 说明 | 限制 |
|--------|------|------|------|------|
| version | string | 是 | 接口版本,当前值为:1.4 | <= 8 characters |
| keyVersion | string | 是 | 密钥版本,当前值为:1 | <= 8 characters |
| requestTime | string | 是 | 请求时间,符合rfc3339规范,格式:yyyy-MM-dd'T'HH:mm:ss.SSSXXX 时间需要在当前时间两分钟内 | <= 32 characters |
| appId | string | 是 | 商户应用Id,PayerMax分配给商户应用的唯一标识 | <= 64 characters |
| merchantNo | string | 否 | 商户号,商户与PayerMax业务签约时生成的唯一标识 | <= 32 characters |
| data | object | 是 | 请求数据体 | - |

#### data 对象

| 参数名 | 类型 | 必填 | 说明 | 限制 |
|--------|------|------|------|------|
| outTradeNo | string | 是 | 商户订单号,唯一标识商户的一笔交易,不能重复,只能包含字母、数字、下划线且不支持大小写敏感。如:AAA和AAa被认为是相同的 | <= 64 characters |
| integrate | string | 是 | 使用PayerMax_Hosted_Payment_Page进行付款方支付信息收集及处理,需传入参数:Hosted_Checkout | <= 16 characters |
| captureMode | string | 否 | 请款模式:MANUAL | - |
| authorizationType | string | 否 | 授权类型:FINAL_AUTH | - |
| subject | string | 是 | 订单标题或产品信息,会展示在用户支付页面,避免使用纯数字。注:巴西钱包Pix不能超过43位 | <= 256 characters |
| totalAmount | number | 是 | 标价金额,金额的单位为元。各个国家币种支持的小数位详见【交易支持国家/地区与币种】,风控限额详见【风控行业限额】 | - |
| currency | string | 是 | 标价币种,大写字母,参见【交易支持国家/地区与币种】 | <= 3 characters |
| country | string | 否 | 国家代码,大写字母,参见【交易支持国家/地区与币种】。如指定了paymentMethodType,则国家代码必须上送且和支付方式对应国家匹配。收银台可用国家地区选择策略为:上送国家代码地区>用户历史使用国家代码地区>用户IP所在国家代码地区。(可用国家地区:交易币种对应的国家与签约国家取交集) | <= 2 characters |
| userId | string | 是 | 商户内部的用户Id,需要保证每个ID唯一性。支付方式绑定后会根据userId进行支付方式推荐 | <= 64 characters |
| language | string | 否 | 收银台页面语言。【支持的国家与币种】 优先级:用户上次使用的语言 > 用户浏览器语言 > 用户ip国家语言 > 商户下单传的语言 > 默认EN | <= 16 characters |
| referralCode | string | 否 | 用于更精准的支付方式推荐,如设备ID、设备指纹等 | <= 32 characters |
| reference | string | 否 | 商户自定义附加数据,可支持商户自定义并在响应中返回 | <= 512 characters |
| frontCallbackUrl | string | 是 | 商户指定的跳转URL,用户完成支付后会被跳转到该地址,以http/https开头或者商户应用的scheme地址。详见【结果页跳转说明】 | <= 1024 characters |
| notifyUrl | string | 否 | 服务端回调通知URL,以http/https开头 可以通过MerchantDashboard平台配置商户通知地址,详情见【配置异步通知地址】,如果交易中上送,则以交易为准,即优先使用接口中传的url。注:如商户平台未配置通知地址,交易也没上送地址,则无法进行回调通知 | <= 256 characters |
| expireTime | string | 否 | 指定关单时间(单位:秒)。最小30分钟,最大1天。若传入则以该时间为关单时间。默认30分钟 | - |
| paymentDetail | object | 否 | 支付信息,非必填 。1、可指定支付方式类型,收银台会拉起该支付方式类型支持的所有目标机构 。2、可指定支付方式类型+目标机构 | - |
| envInfo | object | 否 | 设备信息 | - |
| subMerchant | object | 否 | 二级商户信息 平台类商户需要上送子商户信息 | - |
| goodsDetails | array[object] | 否 | 商品信息,支持传多个。注:电商场景下需要上送。如果传入该对象,则内层必填字段必须传入 | - |
| shippingInfo | object | 否 | 邮寄信息 注:电商场景下需要上送。如果传入该对象,则内层必填字段必须传入 | - |
| billingInfo | object | 否 | 信用卡账单信息。注:如果传入该对象,则内层必填字段必须传入 | - |
| riskParams | object | 否 | 详见风控业务数据【商户上送信息】 | - |
| subscriptionPlan | object | 否 | 订阅计划信息 | - |

## Response

### 200 成功响应

#### Body (application/json)

| 参数名 | 类型 | 必填 | 说明 | 限制 |
|--------|------|------|------|------|
| code | string | 是 | 返回码,'APPLY_SUCCESS'代表成功。只代表接口请求成功,不代表订单状态 | - |
| msg | string | 是 | 返回描述,'Success.' 。只代表接口请求成功,不代表订单状态 | - |
| data | object | 是 | 返回数据体 | - |

#### data 对象

| 参数名 | 类型 | 必填 | 说明 | 限制 |
|--------|------|------|------|------|
| redirectUrl | string | 是 | 跳转地址 | <= 1024 characters |
| outTradeNo | string | 是 | 商户订单号 | <= 64 characters |
| tradeToken | string | 是 | PayerMax流水号 | <= 64 characters |
| status | string | 是 | 交易状态,详见【交易状态】 | <= 32 characters |
