# 退款申请 (Refund Application)

## API Information

- **Method**: POST
- **Endpoint**: `https://pay-gate-uat.payermax.com/aggregate-pay/api/gateway/refund`
- **Content-Type**: `application/json`

## Description

仅适用于支持退款的支付方式，同时仅支持180天内的交易发起退款。

**重要提示**：
- 退款到账时效取决于银行和机构的处理时效

## Request Headers

| Header | Type | Required | Description | Example |
|--------|------|----------|-------------|---------|
| Content-Type | string | ✓ | Request content type | `application/json` |
| sign | string | ✓ | 签名信息请参考技术文档 | `FPFVT3o227JrFRbqu19boZCpVVTF9KznxyRawUmxpfXilHV/0yK46haPhAjNu1hPUMy7Vw/ILXhfzffNm4Fj0apWknlTY9OJxnSoQxS9BTFtc61tn5yV1q69x/kkBl82/qwg+XTJ4fOzy7Mar3VaC1E2PlDA6RkkKBUyNE6RYgsdB+Su7an4+4HVTNAnoe74WyvBgxTLMNg28igBTdqxaO3w/UBY6ObVp7vkqkQGdL1Y+HgmMYaAVwrM3+ALWGId0sJ+YqTY4WJ+0xCRGhaSnybiIjZsQEYyID68WNUfuavDLDsEhaMm/HfQvf5p0R1Ltovp3wwJnEbQcjY458iX5A==` |

## Request Body Parameters

### Root Level Parameters

| Parameter | Type | Required | Max Length | Description |
|-----------|------|----------|------------|-------------|
| version | string | ✓ | 8 | 接口版本 当前值为：1.4 |
| keyVersion | string | ✓ | 8 | 密钥版本 当前值为：1 |
| requestTime | string | ✓ | 32 | 请求时间，符合rfc3339规范，格式：yyyy-MM-dd'T'HH:mm:ss.SSSXXX 时间需要在当前时间两分钟内 |
| appId | string | ✓ | 64 | 商户应用Id，PayerMax分配给商户应用的唯一标识 |
| merchantNo | string | ✗ | 32 | 商户号，商户与PayerMax业务签约时生成的唯一标识 |
| data | object | ✗ | - | 请求数据体 |

### Data Object Parameters

| Parameter | Type | Required | Max Length | Description |
|-----------|------|----------|------------|-------------|
| outRefundNo | string | ✓ | 64 | 商户退款申请号，唯一标识一笔退款申请交易 |
| refundAmount | number | ✓ | - | 退款金额，金额的单位为元。除以下国家外按照各国币种支持的小数点位（最大四位）上送。注意：巴林、科威特、伊拉克，约旦、突尼斯、利比亚、奥马尔地区，本币只支持两位小数；印尼、中国台湾、巴基斯坦、哥伦比亚地区，本币不支持带小数金额。 |
| refundCurrency | string | ✓ | 3 | 退款币种（原交易币种） |
| outTradeNo | string | ✗ | 64 | 原商户订单号，可以传outTradeNo，也可以传tradeToken，不能outTradeNo和tradeToken同时不传 |
| tradeToken | string | ✗ | 64 | 正向交易单的交易Token，可以传outTradeNo，也可以传tradeToken，不能outTradeNo和tradeToken同时不传。Example: `T2025020713159038685354` |
| comments | string | ✗ | 512 | 退款说明（商户退款理由） |
| refundNotifyUrl | string (uri) | ✗ | 256 | 退款回调地址，可后台配置【配置地址】 |

## Response (200)

### Response Body

| Parameter | Type | Required | Max Length | Description |
|-----------|------|----------|------------|-------------|
| code | string | ✓ | - | 返回码，'APPLY_SUCCESS'代表成功。只代表接口请求成功，不代表订单状态。 |
| msg | string | ✓ | - | 返回描述，'Success.'。只代表接口请求成功，不代表订单状态。 |
| data | object | ✓ | - | 返回数据体 |

### Data Object (Response)

| Parameter | Type | Required | Max Length | Description |
|-----------|------|----------|------------|-------------|
| outRefundNo | string | ✓ | 64 | 商户退款申请号 |
| tradeOrderNo | string | ✓ | 64 | 交易订单号 |
| refundTradeNo | string | ✓ | 64 | PayerMax退款流水号 |
| status | string | ✓ | 32 | 退款状态：REFUND_PENDING，REFUND_FAILED |

### Refund Status Values

| Value | Description |
|-------|-------------|
| REFUND_PENDING | 退款处理中 |
| REFUND_FAILED | 退款失败 |

## Special Currency Rules

### 两位小数限制地区
以下地区本币只支持两位小数：
- 巴林
- 科威特
- 伊拉克
- 约旦
- 突尼斯
- 利比亚
- 奥马尔

### 不支持小数地区
以下地区本币不支持带小数金额：
- 印尼
- 中国台湾
- 巴基斯坦
- 哥伦比亚

## Notes

- ✓ = Required field
- ✗ = Optional field
- 仅支持180天内的交易发起退款
- outTradeNo和tradeToken必须至少传一个，不能同时不传
- 接口请求成功不代表退款状态成功，需要根据返回的status判断退款状态
- 退款到账时效取决于银行和机构的处理时效
